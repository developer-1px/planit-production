import"./NZTpNUN0.js";import{o as oe,a as le}from"./erN7JwqA.js";import{X as re,g as e,a5 as h,s as l,aK as ne,a2 as ve,a as C,Z as ce,f as I,_ as u,a0 as c,$ as f,a1 as j}from"./DhavXi9s.js";import{d as de,s as z}from"./DDewMqrm.js";import{i as me}from"./C8zPlSMq.js";import{b as ue}from"./DMofKf_K.js";import{s as y}from"./B0hh_pT5.js";import{s as fe}from"./DKGTjmyz.js";import{b as G}from"./CTWb8ZlO.js";import{P as pe}from"./KyN7jw-T.js";class He{constructor(t){this.notify=t}doAnimation=!1;timer=-1;delay1=0;delay2=0;notify=t=>{};start(){this.doAnimation=!1,this.notify(this),clearTimeout(this.timer),setTimeout(()=>{this.doAnimation=!0,this.delay1=Math.floor(Math.random()*1e3)+1e3,this.delay2=Math.floor(Math.random()*1e3)+1600,this.notify(this),clearTimeout(this.timer),this.timer=setTimeout(()=>{this.doAnimation=!1,this.notify(this)},1e4),this.notify(this)},150)}stop(){clearTimeout(this.timer),this.doAnimation=!1,this.notify(this)}}function X(i,t,n){t||n()}var _e=(i,t)=>{i.stopPropagation(),t()},he=(i,t)=>{i.stopPropagation(),t()},ye=(i,t)=>{i.stopPropagation(),t()},ge=(i,t)=>{i.stopPropagation(),t(i)},ke=I('<section popup="" player-popup=""><div player-media=""></div> <div player-title=""><h1> </h1> <h2> </h2></div> <div layer=""></div> <div player-btn="play"><div></div></div> <div player-btn="full-screen"><div></div></div> <div player-btn="close"><div></div></div> <div player-slider=""><div player-slider-bar=""><div player-slider-active=""></div></div></div></section>'),be=(i,t)=>{i.stopPropagation(),t()},Te=I('<section popup="" player-popup=""><div player-media=""></div> <div player-btn="close"><div></div></div></section>');function Ve(i,t){re(t,!0);let n=h(null),s=h(null),v=h(!0),g=h(!0),E=h(0),k=h("paused"),w;const p=/iPhone|iPad|iPod/i.test(navigator.userAgent);oe(()=>{e(n)&&(l(s,new pe(e(n),{id:t.video.video_id,controls:p,color:"#009be0",title:!1,byline:!1,autoplay:!0,playsinline:!1,loop:!1}),!0),e(s).on("play",()=>{l(k,"played")}),e(s).on("pause",()=>{l(k,"paused")}),e(s).on("timeupdate",a=>{l(E,a.percent*100)}),p||b(),e(s).play())});function b(){l(v,!0),clearTimeout(w),w=window.setTimeout(()=>{l(v,!1)},3e3)}function D(){e(s)&&(e(k)==="played"?e(s).pause():e(s).play())}function J(){const a=document.documentElement;document.fullscreenElement?(l(g,!0),document.exitFullscreen()):a.requestFullscreen().then(()=>{l(g,!1)})}function L(a){if(!e(s))return;const o=a.currentTarget.getBoundingClientRect(),r=(a.clientX-o.left)/o.width;e(s).getDuration().then(d=>{e(s).setCurrentTime(d*r)})}function F(){t.onClose()}le(()=>{clearTimeout(w),e(s)&&e(s).destroy()});var H=ne(),N=ve(H);{var Q=a=>{var o=ke();o.__mousedown=[X,p,b],o.__mousemove=[X,p,b],o.__click=[X,p,b];var _=u(o);G(_,M=>l(n,M),()=>e(n));var r=c(_,2);let d;var m=u(r),W=u(m,!0);f(m);var V=c(m,2),Y=u(V,!0);f(V),f(r);var q=c(r,2);q.__click=D;var T=c(q,2);T.__click=[_e,D];let B;var A=c(T,2);A.__click=[he,J];let K;var x=c(A,2);x.__click=[ye,F];let O;var P=c(x,2);P.__click=[ge,L];let R;var S=u(P),$=u(S);let Z;f(S),f(P),f(o),j((M,ee,te,ie,se,ae)=>{d=y(r,1,"svelte-cvmkg2",null,d,M),z(W,t.video.name),z(Y,t.video.desc),ue(T,"attr-state",e(k)),B=y(T,1,"svelte-cvmkg2",null,B,ee),K=y(A,1,"svelte-cvmkg2",null,K,te),O=y(x,1,"svelte-cvmkg2",null,O,ie),R=y(P,1,"svelte-cvmkg2",null,R,se),Z=fe($,"",Z,ae)},[()=>({visible:e(v)}),()=>({visible:e(v)}),()=>({visible:e(v)}),()=>({visible:e(v)&&e(g)}),()=>({visible:e(v)}),()=>({width:`${e(E)??""}%`})]),C(a,o)},U=a=>{var o=Te(),_=u(o);G(_,m=>l(n,m),()=>e(n));var r=c(_,2);r.__click=[be,F];let d;f(o),j(m=>d=y(r,1,"svelte-cvmkg2",null,d,m),[()=>({visible:e(v)&&e(g)})]),C(a,o)};me(N,a=>{p?a(U,!1):a(Q)})}C(i,H),ce()}de(["mousedown","mousemove","click"]);export{He as T,Ve as V};
